import{c as L,R as v,ap as Ve,P as Le,as as ce,r as u,C as Se,u as Te,ao as je,Y as oe,a5 as D,q as ke,a1 as Re,j as g,a as z,aI as Me}from"./index-2fe9f87b.js";import{T as ze,b as ue,a as Fe,P as Ge,u as $e,I as Ae}from"./index-ed7d1e53.js";function ve(e){var a=e.title,t=e.description,r=e.actions,i=a||t,o=r&&r.length,s=i||o;return[s,i,o]}var Ue=globalThis&&globalThis.__read||function(e,a){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var r=t.call(e),i,o=[],s;try{for(;(a===void 0||a-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(n){s={error:n}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return o},Ke=function(e){var a,t=e.style,r=e.className,i=e.title,o=e.description,s=e.actions,n=e.prefixCls,I=e.simple,C=Ue(ve({title:i,description:o,actions:s}),3),d=C[0],b=C[1],P=C[2];if(!d)return null;var f=n+"-footer",O=L(f,r,(a={},a[f+"-with-actions"]=P,a)),h=function(){var p=v.createElement("div",{className:n+"-actions-list"},s.map(function(E,m){return v.createElement("div",{className:n+"-actions-item",key:""+m},E)}));return I?v.createElement("div",{className:n+"-actions-list"},v.createElement(ze,{prefixCls:n,popup:function(){return p}},v.createElement("div",{className:L(n+"-actions-item",n+"-actions-item-trigger")},v.createElement("span",null,v.createElement(Ve,null))))):p};return v.createElement("div",{className:O,style:t},b&&v.createElement("div",{className:L(f+"-block",n+"-caption")},i&&v.createElement("div",{className:n+"-caption-title",title:i},i),o&&!I&&v.createElement("div",{className:n+"-caption-description",title:o},o)),P&&v.createElement("div",{className:L(f+"-block",n+"-actions")},h()))},de=!Le&&!ce(window==null?void 0:window.IntersectionObserver);function qe(e,a){a===void 0&&(a={});var t=u.useRef(),r=function(){t.current&&(t.current.disconnect(),t.current=null)},i=function(o){o&&(r(),de&&(t.current=new IntersectionObserver(e,a),t.current.observe(o)))};return{observer:t.current,cor:i,dor:r}}var Ye=globalThis&&globalThis.__rest||function(e,a){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&a.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)a.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t},se=globalThis&&globalThis.__read||function(e,a){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var r=t.call(e),i,o=[],s;try{for(;(a===void 0||a-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(n){s={error:n}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return o};function Be(e){var a=e.defaultInView,t=e.unobserverOnEnter,r=t===void 0?!0:t,i=e.onChange,o=e.target,s=Ye(e,["defaultInView","unobserverOnEnter","onChange","target"]),n=se(u.useState(de?a:!0),2),I=n[0],C=n[1],d=u.useCallback(function(h,p){var E=se(h,1),m=E[0],G=p.thresholds.some(function(w){return m.intersectionRatio>=w}),S=G&&m.isIntersecting;C(S),i==null||i(S,m),S&&r&&p.unobserve(m.target)},[i,r]),b=qe(d,s),P=b.cor,f=b.dor,O=b.observer;return u.useEffect(function(){var h=a&&r;return h?f():o&&P(o),f},[o,a,r]),{inView:I,observer:O}}var R=globalThis&&globalThis.__assign||function(){return R=Object.assign||function(e){for(var a,t=1,r=arguments.length;t<r;t++){a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},R.apply(this,arguments)},De=globalThis&&globalThis.__rest||function(e,a){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&a.indexOf(r)<0&&(t[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)a.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(t[r[i]]=e[r[i]]);return t},le=globalThis&&globalThis.__read||function(e,a){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var r=t.call(e),i,o=[],s;try{for(;(a===void 0||a-- >0)&&!(i=r.next()).done;)o.push(i.value)}catch(n){s={error:n}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(s)throw s.error}}return o},H=0,He={footerPosition:"inner",preview:!0};function Je(e,a){var t,r=u.useContext(Se),i=r.getPrefixCls,o=r.componentConfig,s=r.rtl,n=Te(e,He,o==null?void 0:o.Image),I=n.style,C=n.className,d=n.src,b=n.width,P=n.height,f=n.title,O=n.description,h=n.actions,p=n.footerPosition,E=n.simple,m=n.loader,G=n.loaderClassName,S=n.error,w=n.preview,$=n.previewProps,A=n.alt,J=n.onClick,U=n.index,Q=n._index,W=n.onError,X=n.onLoad,x=n.lazyload,fe=De(n,["style","className","src","width","height","title","description","actions","footerPosition","simple","loader","loaderClassName","error","preview","previewProps","alt","onClick","index","_index","onError","onLoad","lazyload"]),me=je(),T=u.useContext(Ge),j=T.previewGroup,ge=T.handleVisibleChange,be=T.registerPreviewUrl,he=T.registerPreviewProps,pe=T.setCurrentIndex,y=u.useMemo(function(){return oe($)?$:{}},[$]),we=u.useMemo(function(){return oe(x)?x:{}},[x]),_=u.useMemo(function(){return D(U)||D(Q)?(H=D(U)?U:Q,H):H++},[]),K=y.src||d,ye=le(ve({title:f,description:O,actions:h}),1),q=ye[0],k=$e("beforeLoad"),Z=k.isLoading,Y=k.isError,N=k.isLoaded,M=k.setStatus,Ce=k.isLazyLoad,ee=le(ke(!1,{defaultValue:y.defaultVisible,value:y.visible}),2),re=ee[0],Pe=ee[1],B=u.useMemo(function(){return Re(y,["visible","defaultVisible","src","onVisibleChange"])},[y]),l=i("image"),_e=!ce(y.visible),Ie=L(l,(t={},t[l+"-rtl"]=s,t[l+"-simple"]=E,t[l+"-loading"]=Z,t[l+"-loading-error"]=Y,t[l+"-with-footer-inner"]=N&&q&&p==="inner",t[l+"-with-footer-outer"]=N&&q&&p==="outer",t[l+"-with-preview"]=N&&w&&!Y&&!_e,t),C),V=u.useRef();function Oe(c){M("loaded"),X&&X(c)}function Ee(c){M("error"),W&&W(c)}function te(c){w&&j?(pe(_),ge(!0)):w&&ie(!0),J&&J(c)}function ie(c){y.onVisibleChange&&y.onVisibleChange(c,re),Pe(c)}var ne=Be(R({target:V.current,defaultInView:!x},we)).inView;u.useEffect(function(){V.current&&(ne?(V.current.src||d)&&V.current.src!==d&&(V.current.src=d,M("loading")):M("lazyload"))},[d,ne]),u.useEffect(function(){if(j){var c=he(_,B);return function(){return c(_)}}},[_,j,B]),u.useEffect(function(){if(j){var c=be(_,K,w);return function(){return c(_)}}},[_,j,K,w]);var xe=z("div",{className:l+"-error",children:[g("div",{className:l+"-error-icon",children:g(Ae,{})}),A&&g("div",{className:l+"-error-alt",children:A})]}),ae=g("div",{className:L(l+"-loader",G),children:z("div",{className:l+"-loader-spin",children:[g(Me,{}),g("div",{className:l+"-loader-spin-text",children:"Loading"})]})}),Ne=function(){if(m===!0)return ae;var c=m||ae;return x||m?c:null};return z("div",{className:Ie,style:Object.assign({width:b,height:P},I),ref:a,children:[g("img",{...R({ref:V,className:l+"-img",tabIndex:0},me({onPressEnter:te}),fe,x||d===void 0?{}:{src:d},{title:f,width:b,height:P,onLoad:Oe,onError:Ee,onClick:te,alt:A})}),!N&&z("div",{className:l+"-overlay",children:[Y&&(S||xe),(Z||Ce)&&Ne()]}),N&&q&&g(Ke,{title:f,description:O,actions:h,prefixCls:l,simple:E}),N&&w&&g(ue,{...R({visible:re,src:K},B,{onVisibleChange:ie})})]})}var Qe=v.forwardRef(Je),F=Qe;F.Preview=ue;F.PreviewGroup=Fe;F.displayName="Image";const Ze=F;export{Ze as I};
